
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Controlling Nuke LUT behavior - Coding at Windmills</title>
  <meta name="author" content="Sean Wallitsch">
  <link rel="author" href="humans.txt">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  
    
  
  <meta name="description" content="The LUT implementation steps that Foundry advises for both 1D and 3D LUTs can use some work. By default, the 1D LUTs affect every &hellip;">
  
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://shidarin.github.io/2013/controlling-nuke-lut-behavior/">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Cantarell' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Coding at Windmills" type="application/atom+xml">
  <meta name="og:type" content="website" />
  <meta name="og:site_name" content="Coding at Windmills" />
  <meta name="og:title" content="Controlling Nuke LUT behavior" />
  <meta name="og:description" content="The LUT implementation steps that Foundry advises for both 1D and 3D LUTs can use some work. By default, the 1D LUTs affect every &hellip;" />
  <meta name="og:url" content="http://shidarin.github.io/2013/controlling-nuke-lut-behavior/"/>
  <meta name="url" content="http://shidarin.github.io/2013/controlling-nuke-lut-behavior/">
  
  <meta name="subject" content="devlutsnukepython"/>
  <meta name="category" content="devlutsnukepython"/>
  
  <meta name="distribution" content="global">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <nav role="navigation"><div class="navbar">
  <div class="navbar-inner">
    <a class="brand" href="/">Coding at Windmills</a>
    <ul class="nav">
      <li><a href="/">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/licensing">Licensing</a></li>
      <li><a href="/blog/archives">Archives</a></li>
    </ul>
    <ul class="nav" data-subscription="rss">
      <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
      
    </ul>
      
    <form class="navbar-form" action="http://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:shidarin.github.io" />
        <input class="span2" type="text" name="q" results="0" placeholder="Search"/>
      </fieldset>
    </form>
      
    
  </div>
</div>
</nav>
  <div class="wrapper_single">
    <div class="container">
      <article class="span10 offset1" role="article">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title">Controlling Nuke LUT Behavior</h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <span class="fn">Sean Wallitsch</span></span>
  

 - 
        








  


<time datetime="2013-12-22T14:33:00-08:00" pubdate data-updated="true">Dec 22<span>nd</span>, 2013</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/dev/'>dev</a>, <a class='category' href='/blog/categories/luts/'>luts</a>, <a class='category' href='/blog/categories/nuke/'>nuke</a>, <a class='category' href='/blog/categories/python/'>python</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>The LUT implementation steps that Foundry advises for both 1D and 3D LUTs can use some work. By default, the 1D LUTs affect every channel (even alphas). For 3D LUTs it depends on the node used, but problems can vary from only affecting the default <code>rgb</code> to touching every layer- even data layers.</p>

<!-- more -->


<p>For those not totally familiar with the concept of LUTs, a good overview is <a href="http://www.lightillusion.com/luts.html">here</a>, while the wikipedia page for <a href="http://en.wikipedia.org/wiki/3D_lookup_table">3D LUTs</a> is actually pretty decent.</p>

<p>All code presented here is covered under a standard <a href="/licensing">MIT license</a>, and owned by Rhythm &amp; Hues (posted with permission). A <a href="http://gist.github.com/shidarin/9925799">gist</a> of this code is also published.</p>

<h2>1D LUTs</h2>

<p>The workflow the foundry advises for a 1D LUT is as follows:</p>

<blockquote><p>To register one of the LUTs in the Project Settings as a Viewer Process, use, for example, the following function in your init.py:</p></blockquote>

<figure class='code'><figcaption><span>Nuke Online Help 8v1 or User Guide 7v8 (page 611) </span><a href='http://help.thefoundry.co.uk/nuke/8.0/#user_guide/configuring_nuke/using_gizmo_viewer_process.html' title='Download code'> Link</a></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number marked'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">nuke</span><span class="o">.</span><span class="n">ViewerProcess</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
</span><span class='line'>    <span class="s">&quot;Cineon&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="n">nuke</span><span class="o">.</span><span class="n">createNode</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span>
</span><span class='line marked start end'>        <span class="s">&quot;ViewerProcess_1DLUT&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;current Cineon&quot;</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>This registers a built-in gizmo called <code>ViewerProcess_1DLUT</code> as a Viewer Process and sets it to use the Cineon LUT. The registered Viewer Process appears in the Viewer Process dropdown menu as Cineon.</p></blockquote>

<h4>Protecting The Alpha Channel</h4>

<p>The built-in gizmo unfortunately lacks the one option we need, limiting the application of the LUT to <code>rgb</code> channels only. However, the gizmo only includes a single node, <code>ViewerLUT</code>, that does include that option. Let&#8217;s create a basic group that includes the <code>ViewerLUT</code> node, but gives us more freedom.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number marked'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">lutGroup1D</span><span class="p">(</span><span class="n">lutName</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot;Builds a proper 1D viewer lut that only affects the rgb channels&quot;&quot;&quot;</span>
</span><span class='line'>    <span class="c"># Start our group</span>
</span><span class='line'>    <span class="n">group</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span class='line'>    <span class="n">group</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">inputNode</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Input</span><span class="p">()</span>  <span class="c"># Group input</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">conversion</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">createNode</span><span class="p">(</span><span class="s">&#39;ViewerLUT&#39;</span><span class="p">)</span>
</span><span class='line marked start end'>    <span class="n">conversion</span><span class="p">[</span><span class="s">&#39;rgb_only&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</span><span class='line'>    <span class="n">conversion</span><span class="p">[</span><span class="s">&#39;current&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">lutName</span><span class="p">)</span>
</span><span class='line'>    <span class="n">conversion</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inputNode</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
</span><span class='line'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">conversion</span><span class="p">],</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">group</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">group</span>
</span></code></pre></td></tr></table></div></figure>


<p>The key is line 10, we need to toggle the <code>rgb_only</code> bool checkbox on the <code>ViewerLUT</code> node so that it doesn&#8217;t affect the alpha channels anymore.</p>

<p>Despite recommending the usage of the <code>ViewerProcess_1DLUT</code>, the Foundry does point out that parameter of the <code>ViewerLUT</code> on the very next page.</p>

<p>Now our 1D LUT is no longer affecting alpha channels, but unfortunately several layers representing data channels. Motion vectors, zdepth, etc, are still being hit with our LUT, as those channels are being shuffled into <code>rgb</code> for display purposes.</p>

<h4>Protecting Data Channels</h4>

<p>We need to add a <code>Remove</code> node to strip these layers before the <code>ViewerLUT</code> node, and then a <code>Copy</code> node afterwards to add them back in. If those layers aren&#8217;t present in the incoming stream, Nuke doesn&#8217;t complain.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>    <span class="c"># Remove special layers if present</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">REMOVE_KNOBS</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;operation&#39;</span><span class="p">:</span> <span class="s">&#39;remove&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels&#39;</span><span class="p">:</span> <span class="s">&#39;depth&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels2&#39;</span><span class="p">:</span> <span class="s">&#39;motion&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels3&#39;</span><span class="p">:</span> <span class="s">&#39;forward&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels4&#39;</span><span class="p">:</span> <span class="s">&#39;backward&#39;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">remove</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Remove</span><span class="p">(</span>
</span><span class='line'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">inputNode</span><span class="p">],</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">knob</span> <span class="ow">in</span> <span class="n">REMOVE_KNOBS</span><span class="p">:</span>
</span><span class='line'>        <span class="n">remove</span><span class="p">[</span><span class="n">knob</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">REMOVE_KNOBS</span><span class="p">[</span><span class="n">knob</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>When changing many knob values at once, it&#8217;s often helpful to define a dictionary whose keys are the knob name, and values are the desired knob value. Then we can iterate through the dictionary, grabbing the knob object, and setting it to the retrieved value from the dictionary.</p>

<p>Here&#8217;s the copy node we need that adds the removed layers back in from the original input image stream:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number marked'>33</span>
<span class='line-number marked'>34</span>
<span class='line-number marked'>35</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>    <span class="c"># Add our special channels back in</span>
</span><span class='line'>    <span class="n">copy</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Copy</span><span class="p">(</span>
</span><span class='line'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">inputNode</span><span class="p">,</span> <span class="n">conversion</span><span class="p">],</span>
</span><span class='line'>        <span class="n">channels</span><span class="o">=</span><span class="s">&#39;all&#39;</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line marked start'>    <span class="c"># We need to eliminate any attempts at auto copy.</span>
</span><span class='line marked'>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span><span class='line marked end'>        <span class="n">copy</span><span class="p">[</span><span class="s">&#39;from&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>With the copy, we set it to <code>all</code> channels and remove the automatically filled in values in the <code>from0</code> and on knobs. We&#8217;ll change the input to the <code>Output</code> node below to be linked to the <code>copy</code> node, and then we&#8217;ll add an expanded docstring.</p>

<h4>Final 1D LUT Function</h4>

<figure class='code'><figcaption><span>lutGroup1D (with changes marked)</span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number marked'>3</span>
<span class='line-number marked'>4</span>
<span class='line-number marked'>5</span>
<span class='line-number marked'>6</span>
<span class='line-number marked'>7</span>
<span class='line-number marked'>8</span>
<span class='line-number marked'>9</span>
<span class='line-number marked'>10</span>
<span class='line-number marked'>11</span>
<span class='line-number marked'>12</span>
<span class='line-number marked'>13</span>
<span class='line-number marked'>14</span>
<span class='line-number marked'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number marked'>23</span>
<span class='line-number marked'>24</span>
<span class='line-number marked'>25</span>
<span class='line-number marked'>26</span>
<span class='line-number marked'>27</span>
<span class='line-number marked'>28</span>
<span class='line-number marked'>29</span>
<span class='line-number marked'>30</span>
<span class='line-number marked'>31</span>
<span class='line-number marked'>32</span>
<span class='line-number marked'>33</span>
<span class='line-number marked'>34</span>
<span class='line-number marked'>35</span>
<span class='line-number marked'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number marked'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number marked'>43</span>
<span class='line-number marked'>44</span>
<span class='line-number marked'>45</span>
<span class='line-number marked'>46</span>
<span class='line-number marked'>47</span>
<span class='line-number marked'>48</span>
<span class='line-number marked'>49</span>
<span class='line-number marked'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number marked'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">lutGroup1D</span><span class="p">(</span><span class="n">lutName</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot;Builds a proper 1D viewer lut that only affects the rgb channels</span>
</span><span class='line marked start'>
</span><span class='line marked'><span class="sd">    Args:</span>
</span><span class='line marked'><span class="sd">        lutName : (str)</span>
</span><span class='line marked'><span class="sd">            The 1d lut name. Must be already registered in Nuke&#39;s settings.</span>
</span><span class='line marked'>
</span><span class='line marked'><span class="sd">    Raises:</span>
</span><span class='line marked'><span class="sd">        N/A</span>
</span><span class='line marked'>
</span><span class='line marked'><span class="sd">    Returns:</span>
</span><span class='line marked'><span class="sd">        (&lt;nuke.node.Group&gt;)</span>
</span><span class='line marked'><span class="sd">            A nuke group node that will handle the 1d LUT correctly.</span>
</span><span class='line marked'>
</span><span class='line marked end'><span class="sd">    &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="c"># Start our group</span>
</span><span class='line'>    <span class="n">group</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">group</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">inputNode</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Input</span><span class="p">()</span>  <span class="c"># Group input</span>
</span><span class='line'>
</span><span class='line marked start'>    <span class="n">REMOVE_KNOBS</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line marked'>        <span class="s">&#39;operation&#39;</span><span class="p">:</span> <span class="s">&#39;remove&#39;</span><span class="p">,</span>
</span><span class='line marked'>        <span class="s">&#39;channels&#39;</span><span class="p">:</span> <span class="s">&#39;depth&#39;</span><span class="p">,</span>
</span><span class='line marked'>        <span class="s">&#39;channels2&#39;</span><span class="p">:</span> <span class="s">&#39;motion&#39;</span><span class="p">,</span>
</span><span class='line marked'>        <span class="s">&#39;channels3&#39;</span><span class="p">:</span> <span class="s">&#39;forward&#39;</span><span class="p">,</span>
</span><span class='line marked'>        <span class="s">&#39;channels4&#39;</span><span class="p">:</span> <span class="s">&#39;backward&#39;</span>
</span><span class='line marked'>    <span class="p">}</span>
</span><span class='line marked'>
</span><span class='line marked'>    <span class="c"># Remove special layers if present</span>
</span><span class='line marked'>    <span class="n">remove</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Remove</span><span class="p">(</span>
</span><span class='line marked'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">inputNode</span><span class="p">],</span>
</span><span class='line marked'>    <span class="p">)</span>
</span><span class='line marked'>    <span class="k">for</span> <span class="n">knob</span> <span class="ow">in</span> <span class="n">REMOVE_KNOBS</span><span class="p">:</span>
</span><span class='line marked end'>        <span class="n">remove</span><span class="p">[</span><span class="n">knob</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">REMOVE_KNOBS</span><span class="p">[</span><span class="n">knob</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">conversion</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">createNode</span><span class="p">(</span><span class="s">&#39;ViewerLUT&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">conversion</span><span class="p">[</span><span class="s">&#39;rgb_only&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</span><span class='line marked start end'>    <span class="n">conversion</span><span class="p">[</span><span class="s">&#39;current&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">lutName</span><span class="p">)</span>
</span><span class='line'>    <span class="n">conversion</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">remove</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line marked start'>    <span class="c"># Add our special channels back in</span>
</span><span class='line marked'>    <span class="n">copy</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Copy</span><span class="p">(</span>
</span><span class='line marked'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">inputNode</span><span class="p">,</span> <span class="n">conversion</span><span class="p">],</span>
</span><span class='line marked'>        <span class="n">channels</span><span class="o">=</span><span class="s">&#39;all&#39;</span>
</span><span class='line marked'>    <span class="p">)</span>
</span><span class='line marked'>    <span class="c"># We need to eliminate any attempts at auto copy.</span>
</span><span class='line marked'>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span><span class='line marked end'>        <span class="n">copy</span><span class="p">[</span><span class="s">&#39;from&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
</span><span class='line marked start end'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">copy</span><span class="p">],</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">group</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">group</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&#8217;s important to return the <code>group</code> object, because that returned object will be used as the Viewer Process itself!</p>

<h4>Adding A LUT With lutGroup1D()</h4>

<p>Now that we have our function, we can use it in place of the <code>ViewerProcess_1DLUT</code> node:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number marked'>3</span>
<span class='line-number'>4</span>
<span class='line-number marked'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">nuke</span><span class="o">.</span><span class="n">ViewerProcess</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
</span><span class='line'>    <span class="s">&quot;Cineon&quot;</span><span class="p">,</span>
</span><span class='line marked start end'>    <span class="n">lutGroup1D</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span>
</span><span class='line marked start end'>        <span class="s">&quot;Cineon&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>3D LUTs</h2>

<p>We have 3 goals for 3D LUTs:</p>

<ol>
<li>Make sure every color layer is being affected by the LUT transform.</li>
<li>Protect data layers from the transform.</li>
<li>Ensure the transform happens in the correct colorspace.</li>
</ol>


<p>We don&#8217;t need to worry about 3D LUTs affecting the alpha channel, because while a 1D LUT affects every channel the same, a 3D LUT has instructions for each color channel specifically- meaning it won&#8217;t have any instructions for alpha channels and will leave them alone.</p>

<p>Foundry gives some example nodes to use for 3D LUTs, such as the <code>Vectorfield</code> node, but doesn&#8217;t mention the best node to use, the <a href="http://opencolorio.org/">OpenColorIO</a> node, <code>OCIOFileTransform</code>.</p>

<h5>Why Use OpenColorIO?</h5>

<p><a href="https://github.com/imageworks/OpenColorIO">OpenColorIO</a> is an open source project sponsored by Sony Imageworks. It has a lot of features, but right now we&#8217;re primarily interested in it because it allows us to select which layers to apply the LUT to- including all of them.</p>

<p>In comparison, the <code>Vectorfield</code> node only affects the default <code>rgb</code> layer, which is a pretty large handicap. The <code>Vectorfield</code> node does have an option for colorspace conversion of input images, which is a plus. We&#8217;ll have to do our own colorspace conversion before applying the LUT with <code>OCIOFileTransform</code>, as almost all LUTs expect the inputted channels to be in a Log colorspace.</p>

<h4>Building A Basic Viewer Process With OCIOFileTransform</h4>

<p>We&#8217;ll use the basic framework of our <code>lutGroup1D()</code> function to create a <code>lutGroup3D()</code>, including protection of data layers.</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number marked'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number marked'>24</span>
<span class='line-number marked'>25</span>
<span class='line-number marked'>26</span>
<span class='line-number marked'>27</span>
<span class='line-number marked'>28</span>
<span class='line-number marked'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number marked'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='python'><span class='line marked start end'><span class="k">def</span> <span class="nf">lutGroup3D</span><span class="p">(</span><span class="n">lutFile</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot;Builds a proper 3D viewer lut that only affects the rgb channels&quot;&quot;&quot;</span>
</span><span class='line'>    <span class="c"># Start our group</span>
</span><span class='line'>    <span class="n">group</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span class='line'>    <span class="n">group</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">inputNode</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Input</span><span class="p">()</span>  <span class="c"># Group input</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">REMOVE_KNOBS</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;operation&#39;</span><span class="p">:</span> <span class="s">&#39;remove&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels&#39;</span><span class="p">:</span> <span class="s">&#39;depth&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels2&#39;</span><span class="p">:</span> <span class="s">&#39;motion&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels3&#39;</span><span class="p">:</span> <span class="s">&#39;forward&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels4&#39;</span><span class="p">:</span> <span class="s">&#39;backward&#39;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Remove special layers if present</span>
</span><span class='line'>    <span class="n">remove</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Remove</span><span class="p">(</span>
</span><span class='line'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">inputNode</span><span class="p">],</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">knob</span> <span class="ow">in</span> <span class="n">REMOVE_KNOBS</span><span class="p">:</span>
</span><span class='line'>        <span class="n">remove</span><span class="p">[</span><span class="n">knob</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">REMOVE_KNOBS</span><span class="p">[</span><span class="n">knob</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line marked start'>    <span class="c"># Use our 3d LUT file</span>
</span><span class='line marked'>    <span class="n">mainLut</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">OCIOFileTransform</span><span class="p">(</span>
</span><span class='line marked'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">remove</span><span class="p">],</span>
</span><span class='line marked'>        <span class="n">channels</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">,</span>
</span><span class='line marked'>        <span class="nb">file</span><span class="o">=</span><span class="n">lutFile</span>
</span><span class='line marked end'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Add our special channels back in</span>
</span><span class='line'>    <span class="n">copy</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Copy</span><span class="p">(</span>
</span><span class='line marked start end'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">inputNode</span><span class="p">,</span> <span class="n">mainLut</span><span class="p">],</span>
</span><span class='line'>        <span class="n">channels</span><span class="o">=</span><span class="s">&#39;all&#39;</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>    <span class="c"># We need to eliminate any attempts at auto copy.</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span><span class='line'>        <span class="n">copy</span><span class="p">[</span><span class="s">&#39;from&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
</span><span class='line'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">copy</span><span class="p">],</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">group</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">group</span>
</span></code></pre></td></tr></table></div></figure>


<p>We&#8217;ve only had to change a few lines here. Instead of a string representing an already registered LUT name, the <code>OCIOFileTransform</code> requires a full filepath, which we need to provide in the <code>lutFile</code> arg.</p>

<p>In addition, we&#8217;ve set <code>channels</code> to <code>all</code>, which (unlike the <code>Vectorfield</code> node) will ensure that every layer&#8217;s <code>rgb</code> will get affected. We&#8217;re already protecting the data channels by removing them, just like in <code>lutGroup1D()</code>.</p>

<h4>Setting Input Colorspace</h4>

<p>Most LUTs require an input colorspace that&#8217;s different from Linear space that Nuke works in. <code>Vectorfield</code> has this conversion as a built in option, but <code>OCIOFileTransform</code> does not, so we&#8217;ll have to add it before getting the correct result.</p>

<p>Traditionally the expected input colorspace is Cineon Log, but on an Arri Alexa show it would be LogC. We&#8217;ll specify which in an arg of the function, and use use a <code>ViewerLUT</code> node to convert from to that.</p>

<p>Why use <code>ViewerLUT</code> as opposed to a <code>Colorspace</code>? Because <code>ViewerLUT</code> lets us specify any of the 1D LUTs currently within the Nuke script, not just the built in ones. This means your pipeline can specify a different version of Cineon Log or an older revision of Alexa LogC.</p>

<p>We&#8217;ll make this input colorspace optional, so if the 3D LUT is built for linear values you can omit the arg.</p>

<h4>Final 3D LUT Function</h4>

<figure class='code'><figcaption><span>lutGroup3D (with changes marked)</span></figcaption><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number marked'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number marked'>4</span>
<span class='line-number marked'>5</span>
<span class='line-number marked'>6</span>
<span class='line-number marked'>7</span>
<span class='line-number marked'>8</span>
<span class='line-number marked'>9</span>
<span class='line-number marked'>10</span>
<span class='line-number marked'>11</span>
<span class='line-number marked'>12</span>
<span class='line-number marked'>13</span>
<span class='line-number marked'>14</span>
<span class='line-number marked'>15</span>
<span class='line-number marked'>16</span>
<span class='line-number marked'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number marked'>39</span>
<span class='line-number marked'>40</span>
<span class='line-number marked'>41</span>
<span class='line-number marked'>42</span>
<span class='line-number marked'>43</span>
<span class='line-number marked'>44</span>
<span class='line-number marked'>45</span>
<span class='line-number marked'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number marked'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
</pre></td><td class='code'><pre><code class='python'><span class='line marked start end'><span class="k">def</span> <span class="nf">lutGroup3D</span><span class="p">(</span><span class="n">lutFile</span><span class="p">,</span> <span class="n">inputSpace</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot;Builds a proper 3D viewer lut that only affects the rgb channels</span>
</span><span class='line'>
</span><span class='line marked start'><span class="sd">    Args:</span>
</span><span class='line marked'><span class="sd">        lutFile : (str)</span>
</span><span class='line marked'><span class="sd">            The filepath to a 3d lut</span>
</span><span class='line marked'><span class="sd">        inputSpace=None : (str)</span>
</span><span class='line marked'><span class="sd">            The colorspace the 3d lut file expects.</span>
</span><span class='line marked'>
</span><span class='line marked'><span class="sd">    Raises:</span>
</span><span class='line marked'><span class="sd">        N/A</span>
</span><span class='line marked'>
</span><span class='line marked'><span class="sd">    Returns:</span>
</span><span class='line marked'><span class="sd">        (&lt;nuke.node.Group&gt;)</span>
</span><span class='line marked'><span class="sd">            A nuke node group that will handle the 3d LUT correctly.</span>
</span><span class='line marked'>
</span><span class='line marked end'><span class="sd">    &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="c"># Start our group</span>
</span><span class='line'>    <span class="n">group</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
</span><span class='line'>    <span class="n">group</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">inputNode</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Input</span><span class="p">()</span>  <span class="c"># Group input</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">REMOVE_KNOBS</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>        <span class="s">&#39;operation&#39;</span><span class="p">:</span> <span class="s">&#39;remove&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels&#39;</span><span class="p">:</span> <span class="s">&#39;depth&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels2&#39;</span><span class="p">:</span> <span class="s">&#39;motion&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels3&#39;</span><span class="p">:</span> <span class="s">&#39;forward&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;channels4&#39;</span><span class="p">:</span> <span class="s">&#39;backward&#39;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Remove special layers if present</span>
</span><span class='line'>    <span class="n">remove</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Remove</span><span class="p">(</span>
</span><span class='line'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">inputNode</span><span class="p">],</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">knob</span> <span class="ow">in</span> <span class="n">REMOVE_KNOBS</span><span class="p">:</span>
</span><span class='line'>        <span class="n">remove</span><span class="p">[</span><span class="n">knob</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">REMOVE_KNOBS</span><span class="p">[</span><span class="n">knob</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line marked start'>    <span class="k">if</span> <span class="n">inputSpace</span><span class="p">:</span>
</span><span class='line marked'>        <span class="c"># Convert to Cineon or LogC colorspace</span>
</span><span class='line marked'>        <span class="n">conversion</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">createNode</span><span class="p">(</span><span class="s">&#39;ViewerLUT&#39;</span><span class="p">)</span>
</span><span class='line marked'>        <span class="n">conversion</span><span class="p">[</span><span class="s">&#39;rgb_only&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</span><span class='line marked'>        <span class="n">conversion</span><span class="p">[</span><span class="s">&#39;current&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">inputSpace</span><span class="p">)</span>
</span><span class='line marked'>        <span class="n">conversion</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">remove</span><span class="p">)</span>
</span><span class='line marked'>    <span class="k">else</span><span class="p">:</span>
</span><span class='line marked end'>        <span class="n">conversion</span> <span class="o">=</span> <span class="n">remove</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Use our 3d LUT file</span>
</span><span class='line'>    <span class="n">mainLut</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">OCIOFileTransform</span><span class="p">(</span>
</span><span class='line marked start end'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">conversion</span><span class="p">],</span>
</span><span class='line'>        <span class="n">channels</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nb">file</span><span class="o">=</span><span class="n">lutFile</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c"># Add our special channels back in</span>
</span><span class='line'>    <span class="n">copy</span> <span class="o">=</span> <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Copy</span><span class="p">(</span>
</span><span class='line'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">inputNode</span><span class="p">,</span> <span class="n">mainLut</span><span class="p">],</span>
</span><span class='line'>        <span class="n">channels</span><span class="o">=</span><span class="s">&#39;all&#39;</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>    <span class="c"># We need to eliminate any attempts at auto copy.</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span><span class='line'>        <span class="n">copy</span><span class="p">[</span><span class="s">&#39;from&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">nuke</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
</span><span class='line'>        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">copy</span><span class="p">],</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">group</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">group</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Adding A LUT With lutGroup3D()</h4>

<p>Now that we have our function, we can use it in place of the <code>Vectorfield</code> node:</p>

<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">nuke</span><span class="o">.</span><span class="n">ViewerProcess</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
</span><span class='line'>    <span class="s">&quot;Rambo XXIV Dailies LUT&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="n">lutGroup3D</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span>
</span><span class='line'>        <span class="s">&quot;/proj/ramboXXIV/share/luts/iridas/dailes.cube&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&quot;AlexaV3LogC&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Final Thoughts</h4>

<p>That should be it. You&#8217;ve still got some odds and ends left over- if you want to add a 3D LUT for every *.cube file found in a folder, you need some way of deriving the LUT&#8217;s desired input colorspace.</p>

<p>Also, a slicker means of doing this would involve creating a base LUT object class, with methods for doing things like deriving input colorspace, building the lut group, and registering it. A class level variable could then keep track of all the created LUTs for science.</p>
</div>


  <footer>
    <p class="meta">
      
  


  
    <span class="byline author vcard">by <span class="fn">Sean Wallitsch</span></span>
  

 - 
      








  


<time datetime="2013-12-22T14:33:00-08:00" pubdate data-updated="true">Dec 22<span>nd</span>, 2013</time> - 
      

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/dev/'>dev</a>, <a class='category' href='/blog/categories/luts/'>luts</a>, <a class='category' href='/blog/categories/nuke/'>nuke</a>, <a class='category' href='/blog/categories/python/'>python</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    
    
      <a class="pull-right" href="/2014/Nuke-Python-Module-Tips/" title="Next Post: Nuke Python Module Tips">Nuke Python Module Tips &raquo;</a>
    
  </footer>

</div>

        
      </article>
    </div>
  </div>
  <div id="footer-widgets">
  <div class="container">
    <div class="row">
  <div class="span3">
    <h2>recent posts</h2>
    <ul class="recent_posts">
      
        <li>
          <a href="/2014/Nuke-Python-Module-Tips/">Nuke Python Module Tips</a>
        </li>
      
        <li>
          <a href="/2013/controlling-nuke-lut-behavior/">Controlling Nuke LUT behavior</a>
        </li>
      
    </ul>
    <h2><a href="/blog/archives">archives</a></h2>
  </div>
  <div class="span3">
    

  </div>
  <div class="span3">
    
<h2>twitter</h2>
<a href="https://twitter.com/shidarin" class="twitter-follow-button" data-show-count="true" data-lang="en">Follow @shidarin</a>


  </div>
  <div class="span3">
    <h2>found on</h2>

<a href="https://github.com/shidarin/" rel="tooltip" title="Github"><img class="social_icon" title="Github" alt="github icon" src="/images/glyphicons_381_github.png"></a>





<a href="http://www.linkedin.com/profile/view?id=27225854" rel="tooltip" title="Linkedin"><img class="social_icon" title="Linkedin" alt="Linkedin icon" src="/images/glyphicons_377_linked_in.png"></a>



<a href="http://twitter.com/shidarin" rel="tooltip" title="Twitter"><img class="social_icon" title="Twitter" alt="Twitter icon" src="/images/glyphicons_391_twitter_t.png"></a>



<a href="http://vimeo.com/shidarin" rel="tooltip" title="Vimeo"><img class="social_icon" title="Vimeo" alt="Vimeo icon" src="/images/glyphicons_982_vimeo.png"></a>



<a href="http://500px.com/alphamatte" rel="tooltip" title="500px"><img class="social_icon" title="500px" alt="500px icon" src="/images/glyphicons_980_500.png"></a>



<a href="http://www.360cities.net/profile/shidarin" rel="tooltip" title="360 Cities Panoramic Photography"><img class="social_icon" title="360 Cities" alt="360 Cities icon" src="/images/glyphicons_981_360cities.png"></a>



<a href="http://steamcommunity.com/id/shidarin" rel="tooltip" title="Steam"><img class="social_icon" title="Steam" alt="Steam icon" src="/images/glyphicons_983_steam.png"></a>







<h2>contact at</h2>
<a href="mailto:sean@grenadehop.com">sean@grenadehop.com</a>


  </div>
</div>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-left">
  <a href="/">Coding at Windmills</a>
  - Copyright &copy; 2014 - Sean Wallitsch
</p>
<p class="pull-right">
  <span>Powered by <a href="http://octopress.org/">Octopress</a>.</span>
  
    <span>Designed by <a href="http://www.AdrianArtiles.com">Adrian Artiles</a>.</span>
  
</p>

  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script>window.jQuery || document.write('<script src="/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script>
<script src="/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.tweet.js" type="text/javascript"></script>
<script src="/javascripts/jquery.instagram.js" type="text/javascript"></script>
<script src="/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
<script src="/javascripts/custom.js" type="text/javascript"></script>








  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
